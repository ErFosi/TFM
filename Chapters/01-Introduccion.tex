\chapter{Introducción}

El Internet de las Cosas (IoT) ha transformado radicalmente la forma en que los dispositivos interactúan con el entorno físico y digital. Sin embargo, este crecimiento exponencial ha expuesto una brecha crítica: la falta de mecanismos robustos para mantener la seguridad de estos dispositivos a lo largo de su ciclo de vida operativo. Esta introducción presenta el contexto del problema, examina el estado actual de la investigación y la práctica industrial, y define los objetivos de este Trabajo de Fin de Máster.

\section{Problemática}

El ecosistema IoT ha experimentado un crecimiento sin precedentes, con miles de millones de dispositivos conectados desplegados en entornos industriales, domésticos, sanitarios y de infraestructuras críticas. A pesar de este despliegue masivo, la seguridad no ha evolucionado al mismo ritmo. Una cantidad alarmante de dispositivos permanece sin actualizar debido a la ausencia de mecanismos efectivos de actualización remota, convirtiéndose en vectores de ataque a gran escala.

Las actualizaciones OTA (Over-The-Air) inseguras, o directamente inexistentes, son uno de los mayores riesgos en el IoT. Datos de la industria \cite{Gartner:IoTSecurity:2023} dicen que cerca del 20\% de las organizaciones han sufrido ataques que venían de dispositivos IoT comprometidos, y que la mayoría de las empresas tienen un riesgo importante por culpa de aparatos sin parchear.

Este problema se complica por dos retos técnicos básicos:

\begin{enumerate}
	\item \textbf{Recursos limitados:} Los dispositivos IoT son muy variados, desde chips muy simples de 8 bits con poquísima memoria hasta sistemas más potentes. Esta variedad hace que no se puedan usar las mismas soluciones de seguridad que usamos en ordenadores normales.

	\item \textbf{La amenaza cuántica:} Los algoritmos usados actualmente para firmar actualizaciones podrían ser vulnerables a los ordenadores cuánticos del futuro. Como los dispositivos IoT suelen durar muchos años, es buena idea pensar en esto desde el principio para los casos donde la seguridad a largo plazo sea clave.
\end{enumerate}
Si a esto se le suma la cantidad de dispositivos que hay, las actualizaciones poco seguras y las amenazas futuras, tenemos un escenario de riesgo importante. Por eso hace falta buscar soluciones nuevas, aprovechando lo que dice la investigación y la experiencia de la industria.

\section{Motivaci\'on}

Lo interesante, y lo que motiva este trabajo, es que ambas perspectivas cuentan historias diferentes pero complementarias. Los estudios han demostrado que es posible construir sistemas de actualización seguros, eficientes y adaptados a dispositivos con recursos limitados. La industria, sin embargo, muestra que estas soluciones no se han adoptado de forma generalizada: los frameworks más usados siguen dependiendo de criptografía tradicional, ninguno integra algoritmos ligeros co ni esquemas post-cuánticos.

Para abordar esta problemática de forma rigurosa, este trabajo adopta una doble perspectiva. Por un lado, el \textbf{estado del arte académico}: qué dice la investigación sobre las vulnerabilidades reales, qué arquitecturas de actualización segura se han propuesto, y qué avances hay en criptografía ligera y post-cuántica. Por otro lado, el \textbf{estado de la práctica}: qué soluciones existen realmente en el mercado (SWUpdate, Mender, hawkBit...), qué limitaciones tienen, y por qué las empresas siguen desplegando dispositivos vulnerables a pesar de que técnicamente existen alternativas mejores.

Ese hueco entre lo que se puede hacer técnicamente y lo que se hace en realidad es donde se centra este TFM. El objetivo es demostrar que se pueden juntar herramientas probadas como SWUpdate con criptografía moderna (ligera y post-cuántica) en una plataforma centralizada que permita gestionar grandes flotas de forma segura.

A esto se suma una fuerte motivación regulatoria. La inminente entrada en vigor de la Cyber Resilience Act (CRA) de la Unión Europea \cite{CRA:2024} convertirá la gestión segura del ciclo de vida en un requisito legal. Asimismo, estándares industriales como la IEC 62443, específicamente en su requisito CR 3.10 (Support for Updates) \cite{IEC62443}, exigen mecanismos robustos para la actualización de componentes. Gracias a la plataforma desarrollada en este trabajo, se facilita el cumplimiento de estos requisitos normativos, proporcionando la infraestructura necesaria para gestionar actualizaciones de forma segura y auditada.

\section{Antecedentes}


Este trabajo surge de una necesidad identificada durante las prácticas laborales realizadas en Ikerlan, donde se trabajó agregando funcionalidades a Lamassu, una Infraestructura de Clave Pública (PKI) especializada en dispositivos IoT. Lamassu proporciona gestión centralizada de dispositivos IoT con gestión de claves asímetricas y autenticación e identificación de dispositivos: desde la provisión inicial de certificados hasta su renovación y revocación de forma segura a escala.
Se propuso la idea de añadir la funcionalidad modular de distribucion de actualizaciones OTA seguras, aprovechando la infraestructura de Lamassu para gestionar las claves y certificados necesarios para firmar y verificar las actualizaciones. 

Este trabajo se centra explícitamente en la distribución de actualizaciones remotas para dispositivos IoT que ejecutan Linux embebido, el entorno mayoritario en dispositivos industriales y comerciales. \enquote{Linux embebido} hace referencia a distribuciones y stacks (Buildroot, Yocto, u-boot, etc.) y a imágenes rootfs y toolchains optimizados para entornos con recursos limitados; no debe confundirse con una instalación de Linux de escritorio o servidor con servicios y recursos plenos. Por tanto, las adaptaciones que este entorno exige son tanto de naturaleza operativa como de límite de recursos.

El problema de fondo es que los dispositivos IoT no son ordenadores ni teléfonos. Un sensor industrial, una bombilla inteligente o un monitor de salud tienen restricciones de hardware muy diferentes: procesadores de bajo consumo, memoria limitada y fuentes de energía restringidas. Aplicar los mismos mecanismos de actualización que usamos en un PC simplemente no funciona, y eso ha llevado a prácticas inseguras: fabricantes que envían actualizaciones sin cifrar, dispositivos que aceptan firmware sin verificar su origen, o productos que salen al mercado sin capacidad de actualización. Estos problemas han facilitado la creación de botnets y ataques DDoS a gran escala en el pasado, por ejemplo, Mirai \cite{Kaspersky:Mirai:2025}. Estudios académicos han identificado además la presencia de SDKs y flujos de actualización inseguros que amplían la superficie de ataque a millones de dispositivos \cite{Ibrahim:AoT:2023}.

Por otra parte, los dispositivos IoT tienen ciclos de vida larguísimos, a veces de décadas, lo que dificulta mucho la gestión de vulnerabilidades y actualizaciones con el tiempo\cite{Hassan:IIoTSecurity:2023}. Durante ese periodo, aparecen nuevas vulnerabilidades, se descubren fallos en algoritmos criptográficos y la amenaza de la computación cuántica pone en evidencia la necesidad de pensar en opciones resistentes a largo plazo. Todo esto subraya la urgencia de adoptar un método centralizado y auditable de gestión de actualizaciones que permita controlar despliegues, gestionar rollbacks y garantizar la ciberresiliencia.
\section{Estado del arte}

Esta sección analiza sistemáticamente la literatura académica y las soluciones tecnológicas existentes para identificar las contribuciones científicas, las limitaciones de las implementaciones actuales, y las brechas que justifican la propuesta de este trabajo. El análisis se estructura en cuatro partes: evidencia empírica sobre vulnerabilidades, plataformas OTA existentes, familias de algoritmos criptográficos emergentes, y análisis crítico de las limitaciones identificadas.

\subsection{Panorama de vulnerabilidades en dispositivos IoT}

Es evidente que la seguridad en IoT es un problema grave, tanto si miramos informes de la industria como estudios académicos. Todos coinciden en que hacen falta soluciones sólidas para actualizar el firmware.

\textbf{Evidencia desde la industria:}

Los informes de la industria pintan un panorama preocupante. Se estima que más de 5.600 millones de dispositivos IoT serán vulnerables en los próximos años, sobre todo con la llegada del 5G y el crecimiento masivo de dispositivos conectados \cite{Cisco:IoTForecast:2025}.

Reportes de seguridad \cite{Gartner:IoTSecurity:2023} evidencian que aproximadamente el 20\% de las organizaciones han detectado ataques basados en dispositivos IoT en sus infraestructuras, y que la gran mayoría de entornos corporativos presentan exposición significativa a riesgos derivados de dispositivos comprometidos o sin actualizar. Esta situación refleja una superficie de ataque en constante expansión, donde la falta de procedimientos de mantenimiento y actualización constituye una debilidad estructural.

Los informes de seguridad destacan consistentemente que los \textit{mecanismos de actualización inseguros} y el \textit{firmware/software obsoleto} se encuentran entre las 10 principales vulnerabilidades de IoT \cite{Fortinet:IoTVulnerabilities}. La falta de aplicación de parches y la antigüedad del código base de muchos dispositivos representa un punto de entrada preferente para los atacantes, siendo a menudo el eslabón más débil de la cadena de seguridad.

Un ejemplo particularmente preocupante de vulnerabilidades en componentes de terceros se reveló en mayo de 2024, cuando se identificaron fallos críticos en la plataforma IoT ThroughTek Kalay (TUTK), afectando a más de cien millones de dispositivos a nivel global, incluyendo cámaras de vigilancia y sistemas de seguridad. La explotación en cadena de estas vulnerabilidades permite comprometer completamente el dispositivo, subrayando cómo un fallo en un componente de terceros puede tener un impacto masivo en todo el ecosistema de productos \cite{Bitdefender:TUTK:2024}.

Adicionalmente, el firmware desactualizado continúa siendo el principal motor de las botnets IoT, como Mirai, que explotan credenciales por defecto o vulnerabilidades conocidas para reclutar dispositivos y lanzar ataques de denegación de servicio distribuido (DDoS) masivos. Incidentes recientes han documentado ataques DDoS sin precedentes impulsados por routers y dispositivos IoT comprometidos \cite{Kaspersky:Mirai:2025}, demostrando que el problema no solo persiste, sino que se amplifica con el crecimiento del ecosistema.

\textbf{Evidencia desde la literatura académica:}

Desde una perspectiva más técnica, el estudio \enquote{AoT: Attack on Things} de Ibrahim et al. \cite{Ibrahim:AoT:2023} ofrece datos empíricos alarmantes sobre la prevalencia de SDKs vulnerables en el ecosistema de actualizaciones OTA. Los autores analizaron 23 dispositivos IoT comerciales y sus aplicaciones móviles asociadas, identificando seis SDKs de actualización de firmware (DFU, Device Firmware Update) que presentan vulnerabilidades críticas. Mediante un análisis automatizado a gran escala, el estudio reveló que 1,356 aplicaciones disponibles en Google Play Store dependen de estos SDKs vulnerables y que, en conjunto, estas aplicaciones gestionan al menos 61 modelos de dispositivos IoT ampliamente distribuidos. Esta cadena de dependencias inseguras subraya la magnitud del problema: millones de dispositivos en el campo son potencialmente explotables a través de vectores de actualización comprometidos.

Investigaciones recientes sobre IoT industrial \cite{Hassan:IIoTSecurity:2023} confirman estos problemas: firmware que raramente se actualiza tras el despliegue, mecanismos de actualización inseguros, y dispositivos con ciclos de vida de décadas sin mantenimiento adecuado. Todo esto subraya la urgencia de plataformas automatizadas de actualización segura que puedan operar de forma continua a lo largo de toda la vida útil del dispositivo.

La evidencia convergente desde múltiples fuentes establece que las vulnerabilidades en mecanismos de actualización no son casos aislados, sino un problema sistémico que afecta a millones de dispositivos desplegados. Esta constatación motiva el análisis de las soluciones tecnológicas existentes para determinar si abordan adecuadamente estos desafíos.

\subsection{Plataformas OTA existentes: análisis comparativo}

En respuesta a las necesidades documentadas de actualización segura, la comunidad de código abierto y diversos proveedores comerciales han desarrollado plataformas especializadas. Sin embargo, el análisis comparativo revela limitaciones significativas en relación con los requisitos identificados.

\textbf{SWUpdate} \cite{SWUpdate} es un framework de código abierto para actualizaciones en sistemas Linux embebidos, con soporte para actualizaciones atómicas (esquemas A/B) y firmas RSA/ECDSA, pero sin gestión centralizada de flotas. En resumen, es un software capaz de instalar las actualizaciones de forma segura en el dispositivo, pero no proporciona una solución completa para la gestión de actualizaciones a gran escala. La gran ventaja de SWUpdate es su adaptabilidad gracias a los modulos y su customización.

\textbf{Eclipse hawkBit} \cite{hawkBit} ofrece gestión backend de actualizaciones OTA a escala empresarial con rollout progresivo, aunque la seguridad criptográfica depende de la implementación del cliente.

\textbf{Mender} \cite{Mender} integra cliente y servidor para actualizaciones OTA con gestión de flotas, pero utiliza exclusivamente algoritmos tradicionales (RSA y ECC) sin soporte para criptografía ligera ni post-cuántica.

\textbf{Balena} \cite{Balena} proporciona gestión de flotas basada en contenedores Docker, introduciendo overhead significativo que lo hace inadecuado para dispositivos muy restringidos.

	extbf{RAUC} \cite{RAUC} es similar a SWUpdate en funcionalidades de actualización atómica, pero tampoco incluye familias de algoritmos criptográficos avanzadas.

La Tabla \ref{tab:comparativa_ota} resume las características principales de estas plataformas.

\begin{table}[htbp]
\centering
\caption{Comparativa de plataformas OTA existentes}
\label{tab:comparativa_ota}
\begin{tabular}{|l|c|c|c|c|c|}
\hline
\textbf{Plataforma} & \textbf{Firmas} & \textbf{Cifrado} & \textbf{LWC} & \textbf{PQC} & \textbf{Gestión flota} \\
\hline
SWUpdate & Sí & Sí & No & No & Externa \\
\hline
hawkBit & Delegada & Delegado & No & No & Sí \\
\hline
Mender & Sí & Sí & No & No & Sí \\
\hline
Balena & Sí & Sí & No & No & Sí \\
\hline
RAUC & Sí & Sí & No & No & Externa \\
\hline
\end{tabular}
\smallskip

\footnotesize{LWC: Lightweight Cryptography; PQC: Post-Quantum Cryptography}
\end{table}

Como se observa, ninguna de las soluciones existentes ofrece soporte simultáneo para criptografía ligera y post-cuántica. Esta carencia representa una limitación significativa dado el crecimiento de dispositivos con recursos extremadamente limitados y la amenaza emergente de la computación cuántica. El presente trabajo se construye sobre SWUpdate como agente de actualización en el dispositivo, aprovechando su madurez y robustez probada, pero extendiéndolo gracias a su personalización y facil agregación de modulos con una capa de gestión centralizada que incorpora las familias de algoritmos criptográficos avanzadas ausentes en las soluciones actuales.

Este análisis revela una brecha clara: mientras existen frameworks robustos para gestión de actualizaciones y organismos de estandarización que han definido familias de algoritmos criptográficos avanzadas, ninguna solución integra ambas. La siguiente subsección examina el estado de estas familias de algoritmos criptográficos emergentes.

\subsection{Necesidad de algoritmos criptográficos eficientes}

La enorme variedad de dispositivos IoT, desde chips minúsculos hasta sistemas potentes, hace que necesitemos diferentes tipos de criptografía. Para las actualizaciones OTA, hay dos familias clave: la criptografía ligera para los dispositivos pequeños, y la post-cuántica para protegernos del futuro.

\textbf{Criptografía ligera: ASCON y el estándar NIST LWC.}

El NIST ha elegido ASCON \cite{NIST:SP800232:2023} como el estándar para criptografía ligera. Está hecho a medida para dispositivos con pocos recursos y ofrece cifrado autenticado (AEAD), lo que garantiza que los datos son confidenciales y no han sido modificados.

Para las actualizaciones OTA, ASCON es ideal: es hasta cinco veces más eficiente que AES si no tienes hardware dedicado, consume muy poca memoria y protege tanto el firmware como sus metadatos, evitando ataques de repetición o modificación.

\textbf{Criptografía post-cuántica: preparación ante amenazas futuras.}

Los ordenadores cuánticos son una amenaza real a medio plazo para los algoritmos que usamos hoy (RSA, ECDSA). Como los dispositivos IoT duran muchos años, es de sentido común pensar en esto desde ya.

El NIST ha seleccionado tres esquemas de firma post-cuántica: MLDSA (buen equilibrio), Falcon (firmas pequeñas) y SPHINCS+ (muy seguro teóricamente). Las firmas digitales son clave para asegurar que el firmware es auténtico, incluso frente a ataques cuánticos.

Que el NIST haya estandarizado estos algoritmos significa que técnicamente es posible usarlos. Pero integrarlos en plataformas reales va despacio. En este proyecto he elegido MLDSA como esquema principal para las firmas digitales, combinándolo con cifrado ligero.


\section{Objetivos}

A partir del análisis de la problemática y lo comentado previamente, se establecen los siguientes objetivos para este Trabajo de Fin de Máster.

\subsection{Propósito y alcance}

Visto el panorama de vulnerabilidades en el ecosistema IoT, las limitaciones de las plataformas OTA existentes y la brecha entre la investigación y la aplicación, este trabajo propone una solución que combina tecnologías consolidadas con algoritmos criptográficos modernos y necesarios.

La estrategia adoptada consiste en utilizar \textbf{SWUpdate} como instalador de actualizaciones en el dispositivo, aprovechando su madurez y robustez probada en entornos de producción industrial, pero extendiendo sus capacidades criptográficas para incluir soporte tanto para \textbf{algoritmos de criptografía ligera (LWC)} como para \textbf{esquemas post-cuánticos}. Esta extensión se integra con una \textbf{plataforma de gestión centralizada de flotas de dispositivos}, diseñada para escalar horizontalmente y proporcionar trazabilidad completa del ciclo de vida de las actualizaciones.


\textbf{Objetivo general:}

Diseñar, implementar y evaluar una plataforma de actualización OTA segura y escalable para dispositivos IoT basada en SWUpdate, extendida con soporte para criptografía ligera (LWC) y post-cuántica, e integrada con una arquitectura de gestión centralizada de flotas, abordando las limitaciones identificadas en soluciones existentes.

\textbf{Objetivos específicos:}

\begin{enumerate}
	\item \textbf{Implementar verificación criptográfica robusta:} Desarrollar mecanismos de firma digital basados en algoritmos tradicionales (RSA/ECDSA) y post-cuánticos (MLDSA) para garantizar la autenticidad e integridad de cada paquete de actualización, mitigando el riesgo de distribución de firmware malicioso documentado en estudios como \enquote{AoT: Attack on Things} \cite{Ibrahim:AoT:2023}.

	\item \textbf{Integrar nuevas opciones criptográficas:} Dar soporte a algoritmos ligeros (ASCON) y post-cuánticos (MLDSA), para cubrir tanto dispositivos muy limitados como aquellos que necesitan protegerse del futuro.

	\item \textbf{Arquitectura escalable en la nube:} Crear una plataforma de gestión que pueda crecer horizontalmente para administrar muchos dispositivos y tener control total sobre las actualizaciones (saber si han fallado, reintentarlas, etc.).
	
	\item \textbf{Integrar frameworks maduros de actualización:} Construir la solución sobre SWUpdate como agente de actualización en el dispositivo, aprovechando su robustez probada en entornos de producción industrial mientras se añade la capa de gestión centralizada y las familias de algoritmos criptográficos avanzadas ausentes en su implementación estándar.
	
\end{enumerate}

\section{Planificación}

Para la consecución de los objetivos de este Trabajo de Fin de Máster, se ha definido un plan de trabajo dividido en tres fases principales, que abarcan desde la investigación inicial hasta el despliegue y validación de la plataforma.

\subsection{Fase 1: Investigación}

El objetivo de esta fase es establecer las bases teóricas y técnicas del proyecto, analizando el estado del arte y seleccionando las tecnologías más adecuadas. En esencia, se busca analizar los estándares actuales, identificar qué algoritmos son usados comúnmente y evaluar las nuevas alternativas disponibles, tal como se ha comentado en la introducción.

\begin{description}
    \item[1.1 Revisión de estándares actuales.] Se realizará un estudio exhaustivo de las normativas y recomendaciones de seguridad vigentes para dispositivos IoT (como las guías de NIST y ETSI), así como de los mecanismos de actualización OTA utilizados actualmente en la industria.
    \item[1.2 Evaluación de algoritmos lightweight y post-cuánticos.] Se analizarán y compararán diferentes algoritmos criptográficos, poniendo el foco en aquellos de la familia de criptografía ligera (LWC) para dispositivos con recursos limitados y en los esquemas de criptografía post-cuántica (PQC) para garantizar la seguridad a largo plazo.
    \item[1.3 Elección de algoritmos para los escenarios planteados.] Basándose en la evaluación anterior, se seleccionarán los algoritmos de firma y cifrado más adecuados para los distintos escenarios de uso definidos, equilibrando seguridad y rendimiento.
\end{description}

\subsection{Fase 2: Diseño e integración de módulos de seguridad para dispositivos IoT}

Esta fase constituye el núcleo del desarrollo técnico, donde se diseñan e implementan los componentes de la plataforma. Se incluye el desarrollo del frontend, que es la web que permitirá a los desarrolladores hacer uso de toda la infraestructura.

\begin{description}
    \item[2.1 Diseño de la arquitectura requerida.] Definición de la arquitectura global del sistema, especificando los componentes del backend, la base de datos, la API de comunicación y la estructura del cliente en el dispositivo IoT.
    \item[2.2 Integración de algoritmos de cifrado y/o firma.] Implementación e integración de las librerías criptográficas seleccionadas en la Fase 1 dentro de los servicios de la plataforma, habilitando las capacidades de firma digital y cifrado de los paquetes de actualización tanto en el backend como en el dispositivo IoT.
    \item[2.3 Desarrollo del módulo de distribución segura de actualizaciones.] Creación del servicio encargado de gestionar el repositorio de actualizaciones, verificar la autenticidad de las peticiones y distribuir los binarios de forma segura a los dispositivos autorizados.
    \item[2.4 Integración de firma y cifrado Backend y Frontend.] Desarrollo de la interfaz web (frontend) y su conexión con el backend, permitiendo a los administradores y desarrolladores subir nuevos firmwares, firmarlos criptográficamente y gestionar las campañas de actualización de manera intuitiva.
    \item[2.5 Contenerización y despliegue en k8s.] Empaquetado de todos los microservicios de la plataforma en contenedores (Docker) y orquestación de su despliegue en un clúster de Kubernetes (k8s) para garantizar la escalabilidad, disponibilidad y facilidad de gestión.
\end{description}

\subsection{Fase 3: Automatización de pruebas, despliegue y ciclo de vida}

La fase final se centra en la calidad, la automatización y la validación del sistema en entornos realistas.

\begin{description}
    \item[3.1 Creación o adaptación del pipeline CICD.] Implementación de flujos de Integración y Despliegue Continuo (CI/CD) para automatizar la construcción de las imágenes, la ejecución de pruebas y el despliegue de nuevas versiones de la plataforma.
    \item[3.2 Definición de tests unitarios y e2e.] Desarrollo de una batería de pruebas automatizadas que incluya tests unitarios para validar la lógica de los componentes individuales y tests de extremo a extremo (e2e) para verificar el flujo completo de actualización OTA.
    \item[3.3 Monitorización y validación para entornos de desarrollo y producción.] Puesta en marcha de herramientas de observabilidad y monitorización para supervisar el rendimiento y la salud del sistema, validando su correcto funcionamiento tanto en entornos de prueba como en producción.
\end{description}

La planificación temporal de estas fases y tareas se detalla en el diagrama de Gantt de la Figura \ref{fig:gantt}.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{imagenes/gantt.png}
    \caption{Planificación temporal del proyecto (Diagrama de Gantt)}
    \label{fig:gantt}
\end{figure}

\section{Pliego de condiciones}

Este apartado detalla los recursos, requisitos y condiciones específicas necesarias para el desarrollo, despliegue e implantación de la plataforma de actualización OTA segura para dispositivos IoT. El pliego se ha adaptado a las características particulares de este proyecto, siguiendo las directrices de la norma UNE 157001 de AENOR y las especificaciones de la EPS-MU.

\subsection{Descripción del producto}

La plataforma desarrollada en este TFM constituye un sistema distribuido de gestión de actualizaciones OTA compuesto por:

\begin{itemize}
    \item \textbf{Módulo de gestión centralizado (Updates):} Servicio backend implementado en Go que orquesta la creación, firma, cifrado y distribución de paquetes de actualización. Proporciona una API REST para la gestión del ciclo de vida completo de las actualizaciones.
    
    \item \textbf{Interfaz web de administración:} Aplicación frontend desarrollada que permite a los administradores gestionar flotas de dispositivos, crear campañas de actualización, monitorizar el estado de los despliegues y configurar políticas de seguridad criptográfica.
    
    \item \textbf{Motor de flujos de trabajo (WFX):} Sistema de orquestación de estados que gestiona el ciclo de vida de las actualizaciones en los dispositivos, soportando workflows directos, por fases y personalizados.
    
    \item \textbf{Agente de actualización en dispositivo:} Cliente basado en SWUpdate extendido con soporte para algoritmos de criptografía ligera (ASCON) y post-cuántica (MLDSA), que se ejecuta en los dispositivos IoT con Linux embebido.
\end{itemize}

El sistema garantiza la confidencialidad mediante cifrado AEAD, la integridad y autenticidad mediante firmas digitales, y proporciona trazabilidad completa del proceso de actualización.

\subsection{Requisitos de hardware y software para el entorno de desarrollo}

Para la configuración del entorno de desarrollo de la plataforma se requieren los siguientes componentes:

\subsubsection{Hardware mínimo requerido}

\begin{itemize}
    \item \textbf{Procesador:} CPU x86\_64 de 4 núcleos o superior (recomendado: 8 núcleos para compilación paralela).
    \item \textbf{Memoria RAM:} 16 GB mínimo (recomendado: 32 GB para desarrollo con contenedores y máquinas virtuales simultáneas).
    \item \textbf{Almacenamiento:} 100 GB de espacio libre en disco SSD para repositorios, contenedores, imágenes de sistema y artefactos de compilación.
    \item \textbf{Red:} Conexión de red estable para descarga de dependencias, acceso a registros de contenedores y comunicación con servicios en la nube.
\end{itemize}

\subsubsection{Software de desarrollo requerido}

\begin{itemize}
    \item \textbf{Sistema operativo:} Linux (Ubuntu 22.04 LTS o superior, Debian 12, Fedora 38+). Otras distribuciones son compatibles siempre que cumplan los requisitos de las herramientas.
    
    \item \textbf{Lenguajes y runtimes:}
    \begin{itemize}
        \item Go 1.21 o superior (requerido para el desarrollo del módulo Updates y WFX).
        \item Node.js 18 LTS o superior y npm/yarn (para el desarrollo del frontend).
        \item Python 3.10+ (para scripts de automatización y SWUGenerator).
        \item GCC/G++ 11+ (para compilación de componentes nativos y SWUpdate).
    \end{itemize}
    
    \item \textbf{Herramientas de contenedores y orquestación:}
    \begin{itemize}
        \item Docker Engine 24.0+ o Podman 4.0+.
        \item Docker Compose 2.0+ para desarrollo local.
        \item Kubernetes 1.27+ (minikube, kind o k3s para desarrollo local; clúster productivo para despliegue).
        \item kubectl y helm para gestión de despliegues.
    \end{itemize}
    
    \item \textbf{Librerías criptográficas:}
    \begin{itemize}
        \item OpenSSL 3.5 o superior (requisito crítico para soporte de algoritmos post-cuánticos).
        \item Implementación oficial de ASCON en C (versión 1.3.0 o superior).
        \item liboqs (Open Quantum Safe) para esquemas PQC adicionales.
    \end{itemize}
    
    \item \textbf{Herramientas de compilación para sistemas embebidos:}
    \begin{itemize}
        \item Yocto Project 4.0+ (Kirkstone) para generación de imágenes Linux embebidas.
        \item Buildroot 2023.02+ como alternativa para sistemas más restringidos.
        \item Toolchains cruzados para las arquitecturas objetivo (ARM, ARM64, RISC-V, etc.).
    \end{itemize}
    
    \item \textbf{Control de versiones y CI/CD:}
    \begin{itemize}
        \item Git 2.30+.
        \item GitLab Runner o GitHub Actions para pipelines de integración continua.
    \end{itemize}
\end{itemize}

\subsection{Requisitos de hardware y software para dispositivos objetivo}

Los dispositivos IoT que ejecutarán el agente de actualización deben cumplir las siguientes especificaciones mínimas:

\subsubsection{Hardware del dispositivo}

\begin{itemize}
    \item \textbf{Procesador:} ARM Cortex-A7 o superior, o equivalente (x86, RISC-V).
    \item \textbf{Memoria RAM:} 128 MB mínimo (recomendado: 256 MB para actualizaciones con streaming).
    \item \textbf{Almacenamiento:} 
    \begin{itemize}
        \item Flash/eMMC/SD con capacidad para esquema A/B: mínimo 2× tamaño del rootfs + 20\% de margen.
        \item Ejemplo: para rootfs de 200 MB, se requieren al menos 500 MB de almacenamiento total.
    \end{itemize}
    \item \textbf{Conectividad:} Ethernet, Wi-Fi o módulo celular (4G/5G) para descarga de actualizaciones OTA.
\end{itemize}

\subsubsection{Software del dispositivo}

\begin{itemize}
    \item \textbf{Sistema operativo:} Linux embebido (kernel 5.10 LTS o superior) generado mediante Yocto Project o Buildroot.
    \item \textbf{Bootloader:} U-Boot 2022.01+ con soporte para variables de entorno persistentes y arranque condicional para estrategia A/B.
    \item \textbf{Estructura de particiones:} Esquema de doble partición (Slot A / Slot B) para rootfs y kernel, con partición de datos persistente separada.
    \item \textbf{SWUpdate:} Versión modificada con soporte para ASCON y MLDSA (proporcionada como parte de este proyecto).
    \item \textbf{Librerías criptográficas en dispositivo:}
    \begin{itemize}
        \item OpenSSL 3.5+ (compilado estáticamente o como librería compartida).
        \item Implementación de ASCON integrada en SWUpdate.
    \end{itemize}
    \item \textbf{Agente SWUpdate configurado:} Cliente compilado con módulo WFX habilitado para comunicación con el backend de gestión.
\end{itemize}

\subsection{Requisitos del entorno de producción}

El despliegue en producción de la plataforma de gestión centralizada requiere:

\subsubsection{Infraestructura de nube o on-premise}

\begin{itemize}
    \item \textbf{Clúster Kubernetes:} Versión 1.27+ con al menos 3 nodos worker para alta disponibilidad.
    \item \textbf{Recursos por nodo:}
    \begin{itemize}
        \item CPU: 4 vCPUs.
        \item RAM: 8 GB.
        \item Almacenamiento: 50 GB de almacenamiento persistente (PersistentVolume) para base de datos y repositorio de artefactos.
    \end{itemize}
    \item \textbf{Balanceador de carga:} Ingress controller (NGINX, Traefik) o balanceador externo para distribución de tráfico.
    \item \textbf{Almacenamiento de objetos:} S3-compatible (AWS S3, MinIO, Ceph) para almacenamiento de paquetes de actualización \texttt{.swu}.
    \item \textbf{Base de datos:} PostgreSQL 14+ o MySQL 8.0+ con soporte para transacciones ACID.
\end{itemize}

\subsubsection{Requisitos de red}

\begin{itemize}
    \item \textbf{Ancho de banda:} Suficiente para soportar descargas simultáneas de firmware por los dispositivos de la flota (se recomienda planificar despliegues por lotes).
    \item \textbf{Certificados SSL/TLS:} Certificados válidos para comunicación cifrada entre dispositivos y backend (Let's Encrypt, CA corporativa).
    \item \textbf{Conectividad dispositivos:} Los dispositivos deben poder alcanzar la API del backend (puertos HTTPS 443) mediante resolución DNS o IP estática.
\end{itemize}

\subsection{Condiciones de seguridad}

La plataforma debe operar bajo las siguientes condiciones de seguridad:

\begin{itemize}
    \item \textbf{Gestión de claves criptográficas:} 
    \begin{itemize}
        \item Las claves privadas de firma deben almacenarse en un HSM (Hardware Security Module) o mediante PKCS\#11.
        \item Las claves simétricas de cifrado deben gestionarse a través del módulo KMS integrado con Lamassu PKI.
        \item Rotación de claves conforme a política definida (recomendado: cada 12 meses o tras compromiso detectado).
    \end{itemize}
    
    \item \textbf{Autenticación y autorización:}
    \begin{itemize}
        \item Autenticación mutua TLS (mTLS) entre dispositivos y backend utilizando certificados X.509 emitidos por Lamassu PKI.
        \item Control de acceso basado en roles (RBAC) para administradores de la plataforma.
    \end{itemize}
    
    \item \textbf{Integridad y trazabilidad:}
    \begin{itemize}
        \item Toda actualización debe estar firmada digitalmente (ECDSA-P256, RSA-2048 o MLDSA según configuración).
        \item Registro auditable de todas las operaciones: creación de paquetes, despliegues, éxitos y fallos.
    \end{itemize}
\end{itemize}

\subsection{Condiciones de cumplimiento normativo}

El sistema ha sido diseñado para facilitar el cumplimiento de las siguientes normativas:

\begin{itemize}
    \item \textbf{Cyber Resilience Act (CRA):} Requisitos de actualización segura durante todo el ciclo de vida del producto, reporte de vulnerabilidades y gestión de incidentes.
    
    \item \textbf{IEC 62443-4-2 (CR 3.10 - Support for Updates):} Mecanismos robustos para la actualización de componentes de software y firmware en sistemas de control industrial.
    
    \item \textbf{NIST SP 800-193:} Protección de la integridad de la plataforma mediante actualizaciones autenticadas y rollback seguro.
    
    \item \textbf{ETSI EN 303 645:} Requisitos de ciberseguridad para dispositivos IoT de consumo, incluyendo actualizaciones seguras y gestión del ciclo de vida.
\end{itemize}

\subsection{Condiciones de implantación para cliente final}

En proyectos donde se despliegue esta plataforma para un cliente específico, se deben considerar las siguientes condiciones adicionales:

\subsubsection{Plan de onboarding de dispositivos}

\begin{itemize}
    \item \textbf{Provisión inicial:} Configuración de certificados digitales para cada dispositivo mediante Lamassu PKI.
    \item \textbf{Registro en DMS:} Asignación de dispositivos a grupos lógicos (Device Management Systems) según criterios del cliente (geográficos, funcionales, etc.).
    \item \textbf{Primera actualización:} Validación del canal OTA mediante actualización de prueba controlada en dispositivo piloto.
\end{itemize}

\subsubsection{Capacitación}

\begin{itemize}
    \item Formación de administradores en el uso de la interfaz web y API de gestión.
    \item Documentación de procedimientos de emergencia: rollback manual, recuperación de dispositivo bloqueado.
\end{itemize}

\subsubsection{Soporte y mantenimiento}

\begin{itemize}
    \item Definición de SLA (Service Level Agreement) para disponibilidad del servicio de actualizaciones.
    \item Política de actualizaciones de seguridad de la propia plataforma (parches del backend, dependencias críticas).
    \item Monitorización continua y alertas ante fallos de actualización en dispositivos.
\end{itemize}

\subsection{Condiciones de ejecución del proyecto}

Durante el desarrollo de este TFM se han aplicado las siguientes condiciones:

\begin{itemize}
    \item \textbf{Metodología ágil:} Desarrollo iterativo con entregas incrementales y revisiones periódicas con tutores.
    \item \textbf{Control de versiones:} Todo el código fuente se gestiona mediante Git con repositorios públicos para componentes open source y privados para extensiones propietarias.
    \item \textbf{Pruebas continuas:} Pipeline CI/CD que ejecuta tests unitarios y de integración en cada commit.
    \item \textbf{Documentación técnica:} Generación automática de documentación de API mediante herramientas como Swagger/OpenAPI.
\end{itemize}

